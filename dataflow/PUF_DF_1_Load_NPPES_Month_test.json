{
	"name": "PUF_DF_1_Load_NPPES_Month_test",
	"properties": {
		"folder": {
			"name": "PUF_1_Load_NPPES"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "PUF_DS_0_raw_cms_nppes",
						"type": "DatasetReference"
					},
					"name": "RawCMSNPPESMonth"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Azure_Qral_Dev_Table",
						"type": "DatasetReference"
					},
					"name": "sinkNPPESMain"
				}
			],
			"transformations": [
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "ConvertEmptyToNull"
				}
			],
			"script": "source(output(\n\t\tNPI as string,\n\t\t{Entity Type Code} as string,\n\t\t{Replacement NPI} as string,\n\t\t{Employer Identification Number (EIN)} as string,\n\t\t{Provider Organization Name (Legal Business Name)} as string,\n\t\t{Provider Last Name (Legal Name)} as string,\n\t\t{Provider First Name} as string,\n\t\t{Provider Middle Name} as string,\n\t\t{Provider Name Prefix Text} as string,\n\t\t{Provider Name Suffix Text} as string,\n\t\t{Provider Credential Text} as string,\n\t\t{Provider Other Organization Name} as string,\n\t\t{Provider Other Organization Name Type Code} as string,\n\t\t{Provider Other Last Name} as string,\n\t\t{Provider Other First Name} as string,\n\t\t{Provider Other Middle Name} as string,\n\t\t{Provider Other Name Prefix Text} as string,\n\t\t{Provider Other Name Suffix Text} as string,\n\t\t{Provider Other Credential Text} as string,\n\t\t{Provider Other Last Name Type Code} as string,\n\t\t{Provider First Line Business Mailing Address} as string,\n\t\t{Provider Second Line Business Mailing Address} as string,\n\t\t{Provider Business Mailing Address City Name} as string,\n\t\t{Provider Business Mailing Address State Name} as string,\n\t\t{Provider Business Mailing Address Postal Code} as string,\n\t\t{Provider Business Mailing Address Country Code (If outside U.S.)} as string,\n\t\t{Provider Business Mailing Address Telephone Number} as string,\n\t\t{Provider Business Mailing Address Fax Number} as string,\n\t\t{Provider First Line Business Practice Location Address} as string,\n\t\t{Provider Second Line Business Practice Location Address} as string,\n\t\t{Provider Business Practice Location Address City Name} as string,\n\t\t{Provider Business Practice Location Address State Name} as string,\n\t\t{Provider Business Practice Location Address Postal Code} as string,\n\t\t{Provider Business Practice Location Address Country Code (If outside U.S.)} as string,\n\t\t{Provider Business Practice Location Address Telephone Number} as string,\n\t\t{Provider Business Practice Location Address Fax Number} as string,\n\t\t{Provider Enumeration Date} as string,\n\t\t{Last Update Date} as string,\n\t\t{NPI Deactivation Reason Code} as string,\n\t\t{NPI Deactivation Date} as string,\n\t\t{NPI Reactivation Date} as string,\n\t\t{Provider Gender Code} as string,\n\t\t{Authorized Official Last Name} as string,\n\t\t{Authorized Official First Name} as string,\n\t\t{Authorized Official Middle Name} as string,\n\t\t{Authorized Official Title or Position} as string,\n\t\t{Authorized Official Telephone Number} as string,\n\t\t{Healthcare Provider Taxonomy Code_1} as string,\n\t\t{Provider License Number_1} as string,\n\t\t{Provider License Number State Code_1} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_1} as string,\n\t\t{Healthcare Provider Taxonomy Code_2} as string,\n\t\t{Provider License Number_2} as string,\n\t\t{Provider License Number State Code_2} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_2} as string,\n\t\t{Healthcare Provider Taxonomy Code_3} as string,\n\t\t{Provider License Number_3} as string,\n\t\t{Provider License Number State Code_3} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_3} as string,\n\t\t{Healthcare Provider Taxonomy Code_4} as string,\n\t\t{Provider License Number_4} as string,\n\t\t{Provider License Number State Code_4} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_4} as string,\n\t\t{Healthcare Provider Taxonomy Code_5} as string,\n\t\t{Provider License Number_5} as string,\n\t\t{Provider License Number State Code_5} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_5} as string,\n\t\t{Healthcare Provider Taxonomy Code_6} as string,\n\t\t{Provider License Number_6} as string,\n\t\t{Provider License Number State Code_6} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_6} as string,\n\t\t{Healthcare Provider Taxonomy Code_7} as string,\n\t\t{Provider License Number_7} as string,\n\t\t{Provider License Number State Code_7} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_7} as string,\n\t\t{Healthcare Provider Taxonomy Code_8} as string,\n\t\t{Provider License Number_8} as string,\n\t\t{Provider License Number State Code_8} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_8} as string,\n\t\t{Healthcare Provider Taxonomy Code_9} as string,\n\t\t{Provider License Number_9} as string,\n\t\t{Provider License Number State Code_9} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_9} as string,\n\t\t{Healthcare Provider Taxonomy Code_10} as string,\n\t\t{Provider License Number_10} as string,\n\t\t{Provider License Number State Code_10} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_10} as string,\n\t\t{Healthcare Provider Taxonomy Code_11} as string,\n\t\t{Provider License Number_11} as string,\n\t\t{Provider License Number State Code_11} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_11} as string,\n\t\t{Healthcare Provider Taxonomy Code_12} as string,\n\t\t{Provider License Number_12} as string,\n\t\t{Provider License Number State Code_12} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_12} as string,\n\t\t{Healthcare Provider Taxonomy Code_13} as string,\n\t\t{Provider License Number_13} as string,\n\t\t{Provider License Number State Code_13} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_13} as string,\n\t\t{Healthcare Provider Taxonomy Code_14} as string,\n\t\t{Provider License Number_14} as string,\n\t\t{Provider License Number State Code_14} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_14} as string,\n\t\t{Healthcare Provider Taxonomy Code_15} as string,\n\t\t{Provider License Number_15} as string,\n\t\t{Provider License Number State Code_15} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_15} as string,\n\t\t{Other Provider Identifier_1} as string,\n\t\t{Other Provider Identifier Type Code_1} as string,\n\t\t{Other Provider Identifier State_1} as string,\n\t\t{Other Provider Identifier Issuer_1} as string,\n\t\t{Other Provider Identifier_2} as string,\n\t\t{Other Provider Identifier Type Code_2} as string,\n\t\t{Other Provider Identifier State_2} as string,\n\t\t{Other Provider Identifier Issuer_2} as string,\n\t\t{Other Provider Identifier_3} as string,\n\t\t{Other Provider Identifier Type Code_3} as string,\n\t\t{Other Provider Identifier State_3} as string,\n\t\t{Other Provider Identifier Issuer_3} as string,\n\t\t{Other Provider Identifier_4} as string,\n\t\t{Other Provider Identifier Type Code_4} as string,\n\t\t{Other Provider Identifier State_4} as string,\n\t\t{Other Provider Identifier Issuer_4} as string,\n\t\t{Other Provider Identifier_5} as string,\n\t\t{Other Provider Identifier Type Code_5} as string,\n\t\t{Other Provider Identifier State_5} as string,\n\t\t{Other Provider Identifier Issuer_5} as string,\n\t\t{Other Provider Identifier_6} as string,\n\t\t{Other Provider Identifier Type Code_6} as string,\n\t\t{Other Provider Identifier State_6} as string,\n\t\t{Other Provider Identifier Issuer_6} as string,\n\t\t{Other Provider Identifier_7} as string,\n\t\t{Other Provider Identifier Type Code_7} as string,\n\t\t{Other Provider Identifier State_7} as string,\n\t\t{Other Provider Identifier Issuer_7} as string,\n\t\t{Other Provider Identifier_8} as string,\n\t\t{Other Provider Identifier Type Code_8} as string,\n\t\t{Other Provider Identifier State_8} as string,\n\t\t{Other Provider Identifier Issuer_8} as string,\n\t\t{Other Provider Identifier_9} as string,\n\t\t{Other Provider Identifier Type Code_9} as string,\n\t\t{Other Provider Identifier State_9} as string,\n\t\t{Other Provider Identifier Issuer_9} as string,\n\t\t{Other Provider Identifier_10} as string,\n\t\t{Other Provider Identifier Type Code_10} as string,\n\t\t{Other Provider Identifier State_10} as string,\n\t\t{Other Provider Identifier Issuer_10} as string,\n\t\t{Other Provider Identifier_11} as string,\n\t\t{Other Provider Identifier Type Code_11} as string,\n\t\t{Other Provider Identifier State_11} as string,\n\t\t{Other Provider Identifier Issuer_11} as string,\n\t\t{Other Provider Identifier_12} as string,\n\t\t{Other Provider Identifier Type Code_12} as string,\n\t\t{Other Provider Identifier State_12} as string,\n\t\t{Other Provider Identifier Issuer_12} as string,\n\t\t{Other Provider Identifier_13} as string,\n\t\t{Other Provider Identifier Type Code_13} as string,\n\t\t{Other Provider Identifier State_13} as string,\n\t\t{Other Provider Identifier Issuer_13} as string,\n\t\t{Other Provider Identifier_14} as string,\n\t\t{Other Provider Identifier Type Code_14} as string,\n\t\t{Other Provider Identifier State_14} as string,\n\t\t{Other Provider Identifier Issuer_14} as string,\n\t\t{Other Provider Identifier_15} as string,\n\t\t{Other Provider Identifier Type Code_15} as string,\n\t\t{Other Provider Identifier State_15} as string,\n\t\t{Other Provider Identifier Issuer_15} as string,\n\t\t{Other Provider Identifier_16} as string,\n\t\t{Other Provider Identifier Type Code_16} as string,\n\t\t{Other Provider Identifier State_16} as string,\n\t\t{Other Provider Identifier Issuer_16} as string,\n\t\t{Other Provider Identifier_17} as string,\n\t\t{Other Provider Identifier Type Code_17} as string,\n\t\t{Other Provider Identifier State_17} as string,\n\t\t{Other Provider Identifier Issuer_17} as string,\n\t\t{Other Provider Identifier_18} as string,\n\t\t{Other Provider Identifier Type Code_18} as string,\n\t\t{Other Provider Identifier State_18} as string,\n\t\t{Other Provider Identifier Issuer_18} as string,\n\t\t{Other Provider Identifier_19} as string,\n\t\t{Other Provider Identifier Type Code_19} as string,\n\t\t{Other Provider Identifier State_19} as string,\n\t\t{Other Provider Identifier Issuer_19} as string,\n\t\t{Other Provider Identifier_20} as string,\n\t\t{Other Provider Identifier Type Code_20} as string,\n\t\t{Other Provider Identifier State_20} as string,\n\t\t{Other Provider Identifier Issuer_20} as string,\n\t\t{Other Provider Identifier_21} as string,\n\t\t{Other Provider Identifier Type Code_21} as string,\n\t\t{Other Provider Identifier State_21} as string,\n\t\t{Other Provider Identifier Issuer_21} as string,\n\t\t{Other Provider Identifier_22} as string,\n\t\t{Other Provider Identifier Type Code_22} as string,\n\t\t{Other Provider Identifier State_22} as string,\n\t\t{Other Provider Identifier Issuer_22} as string,\n\t\t{Other Provider Identifier_23} as string,\n\t\t{Other Provider Identifier Type Code_23} as string,\n\t\t{Other Provider Identifier State_23} as string,\n\t\t{Other Provider Identifier Issuer_23} as string,\n\t\t{Other Provider Identifier_24} as string,\n\t\t{Other Provider Identifier Type Code_24} as string,\n\t\t{Other Provider Identifier State_24} as string,\n\t\t{Other Provider Identifier Issuer_24} as string,\n\t\t{Other Provider Identifier_25} as string,\n\t\t{Other Provider Identifier Type Code_25} as string,\n\t\t{Other Provider Identifier State_25} as string,\n\t\t{Other Provider Identifier Issuer_25} as string,\n\t\t{Other Provider Identifier_26} as string,\n\t\t{Other Provider Identifier Type Code_26} as string,\n\t\t{Other Provider Identifier State_26} as string,\n\t\t{Other Provider Identifier Issuer_26} as string,\n\t\t{Other Provider Identifier_27} as string,\n\t\t{Other Provider Identifier Type Code_27} as string,\n\t\t{Other Provider Identifier State_27} as string,\n\t\t{Other Provider Identifier Issuer_27} as string,\n\t\t{Other Provider Identifier_28} as string,\n\t\t{Other Provider Identifier Type Code_28} as string,\n\t\t{Other Provider Identifier State_28} as string,\n\t\t{Other Provider Identifier Issuer_28} as string,\n\t\t{Other Provider Identifier_29} as string,\n\t\t{Other Provider Identifier Type Code_29} as string,\n\t\t{Other Provider Identifier State_29} as string,\n\t\t{Other Provider Identifier Issuer_29} as string,\n\t\t{Other Provider Identifier_30} as string,\n\t\t{Other Provider Identifier Type Code_30} as string,\n\t\t{Other Provider Identifier State_30} as string,\n\t\t{Other Provider Identifier Issuer_30} as string,\n\t\t{Other Provider Identifier_31} as string,\n\t\t{Other Provider Identifier Type Code_31} as string,\n\t\t{Other Provider Identifier State_31} as string,\n\t\t{Other Provider Identifier Issuer_31} as string,\n\t\t{Other Provider Identifier_32} as string,\n\t\t{Other Provider Identifier Type Code_32} as string,\n\t\t{Other Provider Identifier State_32} as string,\n\t\t{Other Provider Identifier Issuer_32} as string,\n\t\t{Other Provider Identifier_33} as string,\n\t\t{Other Provider Identifier Type Code_33} as string,\n\t\t{Other Provider Identifier State_33} as string,\n\t\t{Other Provider Identifier Issuer_33} as string,\n\t\t{Other Provider Identifier_34} as string,\n\t\t{Other Provider Identifier Type Code_34} as string,\n\t\t{Other Provider Identifier State_34} as string,\n\t\t{Other Provider Identifier Issuer_34} as string,\n\t\t{Other Provider Identifier_35} as string,\n\t\t{Other Provider Identifier Type Code_35} as string,\n\t\t{Other Provider Identifier State_35} as string,\n\t\t{Other Provider Identifier Issuer_35} as string,\n\t\t{Other Provider Identifier_36} as string,\n\t\t{Other Provider Identifier Type Code_36} as string,\n\t\t{Other Provider Identifier State_36} as string,\n\t\t{Other Provider Identifier Issuer_36} as string,\n\t\t{Other Provider Identifier_37} as string,\n\t\t{Other Provider Identifier Type Code_37} as string,\n\t\t{Other Provider Identifier State_37} as string,\n\t\t{Other Provider Identifier Issuer_37} as string,\n\t\t{Other Provider Identifier_38} as string,\n\t\t{Other Provider Identifier Type Code_38} as string,\n\t\t{Other Provider Identifier State_38} as string,\n\t\t{Other Provider Identifier Issuer_38} as string,\n\t\t{Other Provider Identifier_39} as string,\n\t\t{Other Provider Identifier Type Code_39} as string,\n\t\t{Other Provider Identifier State_39} as string,\n\t\t{Other Provider Identifier Issuer_39} as string,\n\t\t{Other Provider Identifier_40} as string,\n\t\t{Other Provider Identifier Type Code_40} as string,\n\t\t{Other Provider Identifier State_40} as string,\n\t\t{Other Provider Identifier Issuer_40} as string,\n\t\t{Other Provider Identifier_41} as string,\n\t\t{Other Provider Identifier Type Code_41} as string,\n\t\t{Other Provider Identifier State_41} as string,\n\t\t{Other Provider Identifier Issuer_41} as string,\n\t\t{Other Provider Identifier_42} as string,\n\t\t{Other Provider Identifier Type Code_42} as string,\n\t\t{Other Provider Identifier State_42} as string,\n\t\t{Other Provider Identifier Issuer_42} as string,\n\t\t{Other Provider Identifier_43} as string,\n\t\t{Other Provider Identifier Type Code_43} as string,\n\t\t{Other Provider Identifier State_43} as string,\n\t\t{Other Provider Identifier Issuer_43} as string,\n\t\t{Other Provider Identifier_44} as string,\n\t\t{Other Provider Identifier Type Code_44} as string,\n\t\t{Other Provider Identifier State_44} as string,\n\t\t{Other Provider Identifier Issuer_44} as string,\n\t\t{Other Provider Identifier_45} as string,\n\t\t{Other Provider Identifier Type Code_45} as string,\n\t\t{Other Provider Identifier State_45} as string,\n\t\t{Other Provider Identifier Issuer_45} as string,\n\t\t{Other Provider Identifier_46} as string,\n\t\t{Other Provider Identifier Type Code_46} as string,\n\t\t{Other Provider Identifier State_46} as string,\n\t\t{Other Provider Identifier Issuer_46} as string,\n\t\t{Other Provider Identifier_47} as string,\n\t\t{Other Provider Identifier Type Code_47} as string,\n\t\t{Other Provider Identifier State_47} as string,\n\t\t{Other Provider Identifier Issuer_47} as string,\n\t\t{Other Provider Identifier_48} as string,\n\t\t{Other Provider Identifier Type Code_48} as string,\n\t\t{Other Provider Identifier State_48} as string,\n\t\t{Other Provider Identifier Issuer_48} as string,\n\t\t{Other Provider Identifier_49} as string,\n\t\t{Other Provider Identifier Type Code_49} as string,\n\t\t{Other Provider Identifier State_49} as string,\n\t\t{Other Provider Identifier Issuer_49} as string,\n\t\t{Other Provider Identifier_50} as string,\n\t\t{Other Provider Identifier Type Code_50} as string,\n\t\t{Other Provider Identifier State_50} as string,\n\t\t{Other Provider Identifier Issuer_50} as string,\n\t\t{Is Sole Proprietor} as string,\n\t\t{Is Organization Subpart} as string,\n\t\t{Parent Organization LBN} as string,\n\t\t{Parent Organization TIN} as string,\n\t\t{Authorized Official Name Prefix Text} as string,\n\t\t{Authorized Official Name Suffix Text} as string,\n\t\t{Authorized Official Credential Text} as string,\n\t\t{Healthcare Provider Taxonomy Group_1} as string,\n\t\t{Healthcare Provider Taxonomy Group_2} as string,\n\t\t{Healthcare Provider Taxonomy Group_3} as string,\n\t\t{Healthcare Provider Taxonomy Group_4} as string,\n\t\t{Healthcare Provider Taxonomy Group_5} as string,\n\t\t{Healthcare Provider Taxonomy Group_6} as string,\n\t\t{Healthcare Provider Taxonomy Group_7} as string,\n\t\t{Healthcare Provider Taxonomy Group_8} as string,\n\t\t{Healthcare Provider Taxonomy Group_9} as string,\n\t\t{Healthcare Provider Taxonomy Group_10} as string,\n\t\t{Healthcare Provider Taxonomy Group_11} as string,\n\t\t{Healthcare Provider Taxonomy Group_12} as string,\n\t\t{Healthcare Provider Taxonomy Group_13} as string,\n\t\t{Healthcare Provider Taxonomy Group_14} as string,\n\t\t{Healthcare Provider Taxonomy Group_15} as string,\n\t\t{Certification Date} as string,\n\t\tdata_month as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from [nppes].[0_raw_cms_nppes] WHERE npi=\\'1003001603\\'',\n\tformat: 'query',\n\tpartitionBy('roundRobin', 1000)) ~> RawCMSNPPESMonth\nConvertEmptyToNull derive({Entity Type} = iif({Entity Type Code}=='1', 'Individual', \n    iif({Entity Type Code}=='2', 'Organization', {Entity Type Code})),\n\t\tdata_month = toInteger(data_month),\n\t\t{Active Flag} = iif({NPI Deactivation Date} != '' && {NPI Reactivation Date} == '', '0', '1'),\n\t\t{Provider Second Line Business Practice Location Address} = replace({Provider Second Line Business Practice Location Address}, '\\\\', ''),\n\t\t{Authorized Official Title or Position} = replace({Authorized Official Title or Position},'\\\\',''),\n\t\t{Provider Enumeration Date} = toDate({Provider Enumeration Date}, 'MM/dd/yyyy'),\n\t\t{Last Update Date} = toDate({Last Update Date}, 'MM/dd/yyyy'),\n\t\t{NPI Deactivation Date} = toDate({NPI Deactivation Date}, 'MM/dd/yyyy'),\n\t\t{NPI Reactivation Date} = toDate({NPI Reactivation Date}, 'MM/dd/yyyy'),\n\t\t{Certification Date} = toDate({Certification Date}, 'MM/dd/yyyy'),\n\tpartitionBy('roundRobin', 100)) ~> DerivedColumn1\nRawCMSNPPESMonth derive(each(match(1==1), $$ = iif($$=='',toString(null()),$$))) ~> ConvertEmptyToNull\nDerivedColumn1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sinkNPPESMain"
		}
	}
}