{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "qral-df-dev"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/PUF_DS_1_LD_cms_nppes_provider_taxonomy')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_Qral_Dev",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "QRAL_AZURE_PUF/PUF_1_LOAD/NPPES"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "nppes",
					"table": "1_ld_cms_nppes_provider_taxonomy"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PUF_DS_1_ld_cms_nppes')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_Qral_Dev",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "QRAL_AZURE_PUF/PUF_1_LOAD/NPPES"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "nppes",
					"table": "1_ld_cms_nppes"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PUF_DS_1_ld_cms_nppes_other_provider_identifiers')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_Qral_Dev",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "QRAL_AZURE_PUF/PUF_1_LOAD/NPPES"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "nppes",
					"table": "1_ld_cms_nppes_other_provider_identifiers"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PUF_DF_1_Load_NPPES_Month')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "PUF_1_Load_NPPES"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "PUF_DS_0_raw_cms_nppes",
								"type": "DatasetReference"
							},
							"name": "RawCMSNPPESMonth"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "PUF_DS_1_ld_cms_nppes",
								"type": "DatasetReference"
							},
							"name": "sinkNPPESMain"
						},
						{
							"dataset": {
								"referenceName": "PUF_DS_1_ld_cms_nppes_other_provider_identifiers",
								"type": "DatasetReference"
							},
							"name": "sinkNPPESOtherProvider"
						},
						{
							"dataset": {
								"referenceName": "PUF_DS_1_LD_cms_nppes_provider_taxonomy",
								"type": "DatasetReference"
							},
							"name": "sinkProviderTaxonomy"
						}
					],
					"transformations": [
						{
							"name": "DerivedColumn1"
						},
						{
							"name": "SelectNPPESMain"
						},
						{
							"name": "SelectNPPESOtherProviderIdentifiers"
						},
						{
							"name": "SelectNPPESProviderTaxonomy"
						},
						{
							"name": "LowerCaseProvTaxonomy"
						},
						{
							"name": "LowerCaseOtherProvId"
						},
						{
							"name": "LowerNPPESMain"
						}
					],
					"script": "source(output(\n\t\tNPI as string,\n\t\t{Entity Type Code} as string,\n\t\t{Replacement NPI} as string,\n\t\t{Employer Identification Number (EIN)} as string,\n\t\t{Provider Organization Name (Legal Business Name)} as string,\n\t\t{Provider Last Name (Legal Name)} as string,\n\t\t{Provider First Name} as string,\n\t\t{Provider Middle Name} as string,\n\t\t{Provider Name Prefix Text} as string,\n\t\t{Provider Name Suffix Text} as string,\n\t\t{Provider Credential Text} as string,\n\t\t{Provider Other Organization Name} as string,\n\t\t{Provider Other Organization Name Type Code} as string,\n\t\t{Provider Other Last Name} as string,\n\t\t{Provider Other First Name} as string,\n\t\t{Provider Other Middle Name} as string,\n\t\t{Provider Other Name Prefix Text} as string,\n\t\t{Provider Other Name Suffix Text} as string,\n\t\t{Provider Other Credential Text} as string,\n\t\t{Provider Other Last Name Type Code} as string,\n\t\t{Provider First Line Business Mailing Address} as string,\n\t\t{Provider Second Line Business Mailing Address} as string,\n\t\t{Provider Business Mailing Address City Name} as string,\n\t\t{Provider Business Mailing Address State Name} as string,\n\t\t{Provider Business Mailing Address Postal Code} as string,\n\t\t{Provider Business Mailing Address Country Code (If outside U.S.)} as string,\n\t\t{Provider Business Mailing Address Telephone Number} as string,\n\t\t{Provider Business Mailing Address Fax Number} as string,\n\t\t{Provider First Line Business Practice Location Address} as string,\n\t\t{Provider Second Line Business Practice Location Address} as string,\n\t\t{Provider Business Practice Location Address City Name} as string,\n\t\t{Provider Business Practice Location Address State Name} as string,\n\t\t{Provider Business Practice Location Address Postal Code} as string,\n\t\t{Provider Business Practice Location Address Country Code (If outside U.S.)} as string,\n\t\t{Provider Business Practice Location Address Telephone Number} as string,\n\t\t{Provider Business Practice Location Address Fax Number} as string,\n\t\t{Provider Enumeration Date} as string,\n\t\t{Last Update Date} as string,\n\t\t{NPI Deactivation Reason Code} as string,\n\t\t{NPI Deactivation Date} as string,\n\t\t{NPI Reactivation Date} as string,\n\t\t{Provider Gender Code} as string,\n\t\t{Authorized Official Last Name} as string,\n\t\t{Authorized Official First Name} as string,\n\t\t{Authorized Official Middle Name} as string,\n\t\t{Authorized Official Title or Position} as string,\n\t\t{Authorized Official Telephone Number} as string,\n\t\t{Healthcare Provider Taxonomy Code_1} as string,\n\t\t{Provider License Number_1} as string,\n\t\t{Provider License Number State Code_1} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_1} as string,\n\t\t{Healthcare Provider Taxonomy Code_2} as string,\n\t\t{Provider License Number_2} as string,\n\t\t{Provider License Number State Code_2} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_2} as string,\n\t\t{Healthcare Provider Taxonomy Code_3} as string,\n\t\t{Provider License Number_3} as string,\n\t\t{Provider License Number State Code_3} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_3} as string,\n\t\t{Healthcare Provider Taxonomy Code_4} as string,\n\t\t{Provider License Number_4} as string,\n\t\t{Provider License Number State Code_4} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_4} as string,\n\t\t{Healthcare Provider Taxonomy Code_5} as string,\n\t\t{Provider License Number_5} as string,\n\t\t{Provider License Number State Code_5} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_5} as string,\n\t\t{Healthcare Provider Taxonomy Code_6} as string,\n\t\t{Provider License Number_6} as string,\n\t\t{Provider License Number State Code_6} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_6} as string,\n\t\t{Healthcare Provider Taxonomy Code_7} as string,\n\t\t{Provider License Number_7} as string,\n\t\t{Provider License Number State Code_7} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_7} as string,\n\t\t{Healthcare Provider Taxonomy Code_8} as string,\n\t\t{Provider License Number_8} as string,\n\t\t{Provider License Number State Code_8} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_8} as string,\n\t\t{Healthcare Provider Taxonomy Code_9} as string,\n\t\t{Provider License Number_9} as string,\n\t\t{Provider License Number State Code_9} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_9} as string,\n\t\t{Healthcare Provider Taxonomy Code_10} as string,\n\t\t{Provider License Number_10} as string,\n\t\t{Provider License Number State Code_10} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_10} as string,\n\t\t{Healthcare Provider Taxonomy Code_11} as string,\n\t\t{Provider License Number_11} as string,\n\t\t{Provider License Number State Code_11} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_11} as string,\n\t\t{Healthcare Provider Taxonomy Code_12} as string,\n\t\t{Provider License Number_12} as string,\n\t\t{Provider License Number State Code_12} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_12} as string,\n\t\t{Healthcare Provider Taxonomy Code_13} as string,\n\t\t{Provider License Number_13} as string,\n\t\t{Provider License Number State Code_13} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_13} as string,\n\t\t{Healthcare Provider Taxonomy Code_14} as string,\n\t\t{Provider License Number_14} as string,\n\t\t{Provider License Number State Code_14} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_14} as string,\n\t\t{Healthcare Provider Taxonomy Code_15} as string,\n\t\t{Provider License Number_15} as string,\n\t\t{Provider License Number State Code_15} as string,\n\t\t{Healthcare Provider Primary Taxonomy Switch_15} as string,\n\t\t{Other Provider Identifier_1} as string,\n\t\t{Other Provider Identifier Type Code_1} as string,\n\t\t{Other Provider Identifier State_1} as string,\n\t\t{Other Provider Identifier Issuer_1} as string,\n\t\t{Other Provider Identifier_2} as string,\n\t\t{Other Provider Identifier Type Code_2} as string,\n\t\t{Other Provider Identifier State_2} as string,\n\t\t{Other Provider Identifier Issuer_2} as string,\n\t\t{Other Provider Identifier_3} as string,\n\t\t{Other Provider Identifier Type Code_3} as string,\n\t\t{Other Provider Identifier State_3} as string,\n\t\t{Other Provider Identifier Issuer_3} as string,\n\t\t{Other Provider Identifier_4} as string,\n\t\t{Other Provider Identifier Type Code_4} as string,\n\t\t{Other Provider Identifier State_4} as string,\n\t\t{Other Provider Identifier Issuer_4} as string,\n\t\t{Other Provider Identifier_5} as string,\n\t\t{Other Provider Identifier Type Code_5} as string,\n\t\t{Other Provider Identifier State_5} as string,\n\t\t{Other Provider Identifier Issuer_5} as string,\n\t\t{Other Provider Identifier_6} as string,\n\t\t{Other Provider Identifier Type Code_6} as string,\n\t\t{Other Provider Identifier State_6} as string,\n\t\t{Other Provider Identifier Issuer_6} as string,\n\t\t{Other Provider Identifier_7} as string,\n\t\t{Other Provider Identifier Type Code_7} as string,\n\t\t{Other Provider Identifier State_7} as string,\n\t\t{Other Provider Identifier Issuer_7} as string,\n\t\t{Other Provider Identifier_8} as string,\n\t\t{Other Provider Identifier Type Code_8} as string,\n\t\t{Other Provider Identifier State_8} as string,\n\t\t{Other Provider Identifier Issuer_8} as string,\n\t\t{Other Provider Identifier_9} as string,\n\t\t{Other Provider Identifier Type Code_9} as string,\n\t\t{Other Provider Identifier State_9} as string,\n\t\t{Other Provider Identifier Issuer_9} as string,\n\t\t{Other Provider Identifier_10} as string,\n\t\t{Other Provider Identifier Type Code_10} as string,\n\t\t{Other Provider Identifier State_10} as string,\n\t\t{Other Provider Identifier Issuer_10} as string,\n\t\t{Other Provider Identifier_11} as string,\n\t\t{Other Provider Identifier Type Code_11} as string,\n\t\t{Other Provider Identifier State_11} as string,\n\t\t{Other Provider Identifier Issuer_11} as string,\n\t\t{Other Provider Identifier_12} as string,\n\t\t{Other Provider Identifier Type Code_12} as string,\n\t\t{Other Provider Identifier State_12} as string,\n\t\t{Other Provider Identifier Issuer_12} as string,\n\t\t{Other Provider Identifier_13} as string,\n\t\t{Other Provider Identifier Type Code_13} as string,\n\t\t{Other Provider Identifier State_13} as string,\n\t\t{Other Provider Identifier Issuer_13} as string,\n\t\t{Other Provider Identifier_14} as string,\n\t\t{Other Provider Identifier Type Code_14} as string,\n\t\t{Other Provider Identifier State_14} as string,\n\t\t{Other Provider Identifier Issuer_14} as string,\n\t\t{Other Provider Identifier_15} as string,\n\t\t{Other Provider Identifier Type Code_15} as string,\n\t\t{Other Provider Identifier State_15} as string,\n\t\t{Other Provider Identifier Issuer_15} as string,\n\t\t{Other Provider Identifier_16} as string,\n\t\t{Other Provider Identifier Type Code_16} as string,\n\t\t{Other Provider Identifier State_16} as string,\n\t\t{Other Provider Identifier Issuer_16} as string,\n\t\t{Other Provider Identifier_17} as string,\n\t\t{Other Provider Identifier Type Code_17} as string,\n\t\t{Other Provider Identifier State_17} as string,\n\t\t{Other Provider Identifier Issuer_17} as string,\n\t\t{Other Provider Identifier_18} as string,\n\t\t{Other Provider Identifier Type Code_18} as string,\n\t\t{Other Provider Identifier State_18} as string,\n\t\t{Other Provider Identifier Issuer_18} as string,\n\t\t{Other Provider Identifier_19} as string,\n\t\t{Other Provider Identifier Type Code_19} as string,\n\t\t{Other Provider Identifier State_19} as string,\n\t\t{Other Provider Identifier Issuer_19} as string,\n\t\t{Other Provider Identifier_20} as string,\n\t\t{Other Provider Identifier Type Code_20} as string,\n\t\t{Other Provider Identifier State_20} as string,\n\t\t{Other Provider Identifier Issuer_20} as string,\n\t\t{Other Provider Identifier_21} as string,\n\t\t{Other Provider Identifier Type Code_21} as string,\n\t\t{Other Provider Identifier State_21} as string,\n\t\t{Other Provider Identifier Issuer_21} as string,\n\t\t{Other Provider Identifier_22} as string,\n\t\t{Other Provider Identifier Type Code_22} as string,\n\t\t{Other Provider Identifier State_22} as string,\n\t\t{Other Provider Identifier Issuer_22} as string,\n\t\t{Other Provider Identifier_23} as string,\n\t\t{Other Provider Identifier Type Code_23} as string,\n\t\t{Other Provider Identifier State_23} as string,\n\t\t{Other Provider Identifier Issuer_23} as string,\n\t\t{Other Provider Identifier_24} as string,\n\t\t{Other Provider Identifier Type Code_24} as string,\n\t\t{Other Provider Identifier State_24} as string,\n\t\t{Other Provider Identifier Issuer_24} as string,\n\t\t{Other Provider Identifier_25} as string,\n\t\t{Other Provider Identifier Type Code_25} as string,\n\t\t{Other Provider Identifier State_25} as string,\n\t\t{Other Provider Identifier Issuer_25} as string,\n\t\t{Other Provider Identifier_26} as string,\n\t\t{Other Provider Identifier Type Code_26} as string,\n\t\t{Other Provider Identifier State_26} as string,\n\t\t{Other Provider Identifier Issuer_26} as string,\n\t\t{Other Provider Identifier_27} as string,\n\t\t{Other Provider Identifier Type Code_27} as string,\n\t\t{Other Provider Identifier State_27} as string,\n\t\t{Other Provider Identifier Issuer_27} as string,\n\t\t{Other Provider Identifier_28} as string,\n\t\t{Other Provider Identifier Type Code_28} as string,\n\t\t{Other Provider Identifier State_28} as string,\n\t\t{Other Provider Identifier Issuer_28} as string,\n\t\t{Other Provider Identifier_29} as string,\n\t\t{Other Provider Identifier Type Code_29} as string,\n\t\t{Other Provider Identifier State_29} as string,\n\t\t{Other Provider Identifier Issuer_29} as string,\n\t\t{Other Provider Identifier_30} as string,\n\t\t{Other Provider Identifier Type Code_30} as string,\n\t\t{Other Provider Identifier State_30} as string,\n\t\t{Other Provider Identifier Issuer_30} as string,\n\t\t{Other Provider Identifier_31} as string,\n\t\t{Other Provider Identifier Type Code_31} as string,\n\t\t{Other Provider Identifier State_31} as string,\n\t\t{Other Provider Identifier Issuer_31} as string,\n\t\t{Other Provider Identifier_32} as string,\n\t\t{Other Provider Identifier Type Code_32} as string,\n\t\t{Other Provider Identifier State_32} as string,\n\t\t{Other Provider Identifier Issuer_32} as string,\n\t\t{Other Provider Identifier_33} as string,\n\t\t{Other Provider Identifier Type Code_33} as string,\n\t\t{Other Provider Identifier State_33} as string,\n\t\t{Other Provider Identifier Issuer_33} as string,\n\t\t{Other Provider Identifier_34} as string,\n\t\t{Other Provider Identifier Type Code_34} as string,\n\t\t{Other Provider Identifier State_34} as string,\n\t\t{Other Provider Identifier Issuer_34} as string,\n\t\t{Other Provider Identifier_35} as string,\n\t\t{Other Provider Identifier Type Code_35} as string,\n\t\t{Other Provider Identifier State_35} as string,\n\t\t{Other Provider Identifier Issuer_35} as string,\n\t\t{Other Provider Identifier_36} as string,\n\t\t{Other Provider Identifier Type Code_36} as string,\n\t\t{Other Provider Identifier State_36} as string,\n\t\t{Other Provider Identifier Issuer_36} as string,\n\t\t{Other Provider Identifier_37} as string,\n\t\t{Other Provider Identifier Type Code_37} as string,\n\t\t{Other Provider Identifier State_37} as string,\n\t\t{Other Provider Identifier Issuer_37} as string,\n\t\t{Other Provider Identifier_38} as string,\n\t\t{Other Provider Identifier Type Code_38} as string,\n\t\t{Other Provider Identifier State_38} as string,\n\t\t{Other Provider Identifier Issuer_38} as string,\n\t\t{Other Provider Identifier_39} as string,\n\t\t{Other Provider Identifier Type Code_39} as string,\n\t\t{Other Provider Identifier State_39} as string,\n\t\t{Other Provider Identifier Issuer_39} as string,\n\t\t{Other Provider Identifier_40} as string,\n\t\t{Other Provider Identifier Type Code_40} as string,\n\t\t{Other Provider Identifier State_40} as string,\n\t\t{Other Provider Identifier Issuer_40} as string,\n\t\t{Other Provider Identifier_41} as string,\n\t\t{Other Provider Identifier Type Code_41} as string,\n\t\t{Other Provider Identifier State_41} as string,\n\t\t{Other Provider Identifier Issuer_41} as string,\n\t\t{Other Provider Identifier_42} as string,\n\t\t{Other Provider Identifier Type Code_42} as string,\n\t\t{Other Provider Identifier State_42} as string,\n\t\t{Other Provider Identifier Issuer_42} as string,\n\t\t{Other Provider Identifier_43} as string,\n\t\t{Other Provider Identifier Type Code_43} as string,\n\t\t{Other Provider Identifier State_43} as string,\n\t\t{Other Provider Identifier Issuer_43} as string,\n\t\t{Other Provider Identifier_44} as string,\n\t\t{Other Provider Identifier Type Code_44} as string,\n\t\t{Other Provider Identifier State_44} as string,\n\t\t{Other Provider Identifier Issuer_44} as string,\n\t\t{Other Provider Identifier_45} as string,\n\t\t{Other Provider Identifier Type Code_45} as string,\n\t\t{Other Provider Identifier State_45} as string,\n\t\t{Other Provider Identifier Issuer_45} as string,\n\t\t{Other Provider Identifier_46} as string,\n\t\t{Other Provider Identifier Type Code_46} as string,\n\t\t{Other Provider Identifier State_46} as string,\n\t\t{Other Provider Identifier Issuer_46} as string,\n\t\t{Other Provider Identifier_47} as string,\n\t\t{Other Provider Identifier Type Code_47} as string,\n\t\t{Other Provider Identifier State_47} as string,\n\t\t{Other Provider Identifier Issuer_47} as string,\n\t\t{Other Provider Identifier_48} as string,\n\t\t{Other Provider Identifier Type Code_48} as string,\n\t\t{Other Provider Identifier State_48} as string,\n\t\t{Other Provider Identifier Issuer_48} as string,\n\t\t{Other Provider Identifier_49} as string,\n\t\t{Other Provider Identifier Type Code_49} as string,\n\t\t{Other Provider Identifier State_49} as string,\n\t\t{Other Provider Identifier Issuer_49} as string,\n\t\t{Other Provider Identifier_50} as string,\n\t\t{Other Provider Identifier Type Code_50} as string,\n\t\t{Other Provider Identifier State_50} as string,\n\t\t{Other Provider Identifier Issuer_50} as string,\n\t\t{Is Sole Proprietor} as string,\n\t\t{Is Organization Subpart} as string,\n\t\t{Parent Organization LBN} as string,\n\t\t{Parent Organization TIN} as string,\n\t\t{Authorized Official Name Prefix Text} as string,\n\t\t{Authorized Official Name Suffix Text} as string,\n\t\t{Authorized Official Credential Text} as string,\n\t\t{Healthcare Provider Taxonomy Group_1} as string,\n\t\t{Healthcare Provider Taxonomy Group_2} as string,\n\t\t{Healthcare Provider Taxonomy Group_3} as string,\n\t\t{Healthcare Provider Taxonomy Group_4} as string,\n\t\t{Healthcare Provider Taxonomy Group_5} as string,\n\t\t{Healthcare Provider Taxonomy Group_6} as string,\n\t\t{Healthcare Provider Taxonomy Group_7} as string,\n\t\t{Healthcare Provider Taxonomy Group_8} as string,\n\t\t{Healthcare Provider Taxonomy Group_9} as string,\n\t\t{Healthcare Provider Taxonomy Group_10} as string,\n\t\t{Healthcare Provider Taxonomy Group_11} as string,\n\t\t{Healthcare Provider Taxonomy Group_12} as string,\n\t\t{Healthcare Provider Taxonomy Group_13} as string,\n\t\t{Healthcare Provider Taxonomy Group_14} as string,\n\t\t{Healthcare Provider Taxonomy Group_15} as string,\n\t\t{Certification Date} as string,\n\t\tdata_month as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> RawCMSNPPESMonth\nRawCMSNPPESMonth derive({Entity Type} = iif({Entity Type Code}=='1', 'Individual', \n    iif({Entity Type Code}=='2', 'Organization', {Entity Type Code})),\n\t\tdata_month = toInteger(data_month),\n\t\t{Active Flag} = iif({NPI Deactivation Date} != '' && {NPI Reactivation Date} == '', '0', '1'),\n\t\t{Provider Second Line Business Practice Location Address} = replace({Provider Second Line Business Practice Location Address}, '\\\\', ''),\n\t\t{Authorized Official Title or Position} = replace({Authorized Official Title or Position},'\\\\',''),\n\t\t{Provider Enumeration Date} = toDate({Provider Enumeration Date}, 'MM/dd/yyyy'),\n\t\t{Last Update Date} = toDate({Last Update Date}, 'MM/dd/yyyy'),\n\t\t{NPI Deactivation Date} = toDate({NPI Deactivation Date}, 'MM/dd/yyyy'),\n\t\t{NPI Reactivation Date} = toDate({NPI Reactivation Date}, 'MM/dd/yyyy'),\n\t\t{Certification Date} = toDate({Certification Date}, 'MM/dd/yyyy'),\n\tpartitionBy('roundRobin', 100)) ~> DerivedColumn1\nDerivedColumn1 select(mapColumn(\n\t\tNPI,\n\t\tdata_month,\n\t\t{Active Flag},\n\t\t{Entity Type Code},\n\t\t{Entity Type},\n\t\t{Replacement NPI},\n\t\t{Employer Identification Number (EIN)},\n\t\t{Provider Organization Name (Legal Business Name)},\n\t\t{Provider Last Name (Legal Name)},\n\t\t{Provider First Name},\n\t\t{Provider Middle Name},\n\t\t{Provider Name Prefix Text},\n\t\t{Provider Name Suffix Text},\n\t\t{Provider Credential Text},\n\t\t{Provider Other Organization Name},\n\t\t{Provider Other Organization Name Type Code},\n\t\t{Provider Other Last Name},\n\t\t{Provider Other First Name},\n\t\t{Provider Other Middle Name},\n\t\t{Provider Other Name Prefix Text},\n\t\t{Provider Other Name Suffix Text},\n\t\t{Provider Other Credential Text},\n\t\t{Provider Other Last Name Type Code},\n\t\t{Provider First Line Business Mailing Address},\n\t\t{Provider Second Line Business Mailing Address},\n\t\t{Provider Business Mailing Address City Name},\n\t\t{Provider Business Mailing Address State Name},\n\t\t{Provider Business Mailing Address Postal Code},\n\t\t{Provider Business Mailing Address Country Code (if outside U.S.) } = {Provider Business Mailing Address Country Code (If outside U.S.)},\n\t\t{Provider Business Mailing Address Telephone Number},\n\t\t{Provider Business Mailing Address Fax Number},\n\t\t{Provider First Line Business Practice Location Address},\n\t\t{Provider Second Line Business Practice Location Address},\n\t\t{Provider Business Practice Location Address City Name},\n\t\t{Provider Business Practice Location Address State Name},\n\t\t{Provider Business Practice Location Address Postal Code},\n\t\t{Provider Business Practice Location Address Country Code Out US} = {Provider Business Practice Location Address Country Code (If outside U.S.)},\n\t\t{Provider Business Practice Location Address Telephone Number},\n\t\t{Provider Business Practice Location Address Fax Number},\n\t\t{Provider Enumeration Date},\n\t\t{Last Update Date},\n\t\t{NPI Deactivation Reason Code},\n\t\t{NPI Deactivation Date},\n\t\t{NPI Reactivation Date},\n\t\t{Provider Gender Code},\n\t\t{Authorized Official Last Name},\n\t\t{Authorized Official First Name},\n\t\t{Authorized Official Middle Name},\n\t\t{Authorized Official Title or Position},\n\t\t{Authorized Official Telephone Number},\n\t\t{Healthcare Provider Taxonomy Code_1},\n\t\t{Provider License Number_1},\n\t\t{Provider License Number State Code_1},\n\t\t{Healthcare Provider Primary Taxonomy Switch_1},\n\t\t{Healthcare Provider Taxonomy Code_2},\n\t\t{Provider License Number_2},\n\t\t{Provider License Number State Code_2},\n\t\t{Healthcare Provider Primary Taxonomy Switch_2},\n\t\t{Healthcare Provider Taxonomy Code_3},\n\t\t{Provider License Number_3},\n\t\t{Provider License Number State Code_3},\n\t\t{Healthcare Provider Primary Taxonomy Switch_3},\n\t\t{Is Sole Proprietor},\n\t\t{Is Organization Subpart},\n\t\t{Is Sole Proprietor},\n\t\t{Is Organization Subpart},\n\t\t{Parent Organization LBN},\n\t\t{Parent Organization TIN},\n\t\t{Authorized Official Name Prefix Text},\n\t\t{Authorized Official Name Suffix Text},\n\t\t{Authorized Official Credential Text},\n\t\t{Healthcare Provider Taxonomy Group_1},\n\t\t{Healthcare Provider Taxonomy Group_2},\n\t\t{Healthcare Provider Taxonomy Group_3}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectNPPESMain\nDerivedColumn1 select(mapColumn(\n\t\tNPI,\n\t\tdata_month,\n\t\t{Active Flag},\n\t\t{Entity Type},\n\t\t{Entity Type Code},\n\t\t{Other Provider Identifier_1},\n\t\t{Other Provider Identifier Type Code_1},\n\t\t{Other Provider Identifier State_1},\n\t\t{Other Provider Identifier Issuer_1},\n\t\t{Other Provider Identifier_2},\n\t\t{Other Provider Identifier Type Code_2},\n\t\t{Other Provider Identifier State_2},\n\t\t{Other Provider Identifier Issuer_2},\n\t\t{Other Provider Identifier_3},\n\t\t{Other Provider Identifier Type Code_3},\n\t\t{Other Provider Identifier State_3},\n\t\t{Other Provider Identifier Issuer_3},\n\t\t{Other Provider Identifier_4},\n\t\t{Other Provider Identifier Type Code_4},\n\t\t{Other Provider Identifier State_4},\n\t\t{Other Provider Identifier Issuer_4},\n\t\t{Other Provider Identifier_5},\n\t\t{Other Provider Identifier Type Code_5},\n\t\t{Other Provider Identifier State_5},\n\t\t{Other Provider Identifier Issuer_5},\n\t\t{Other Provider Identifier_6},\n\t\t{Other Provider Identifier Type Code_6},\n\t\t{Other Provider Identifier State_6},\n\t\t{Other Provider Identifier Issuer_6},\n\t\t{Other Provider Identifier_7},\n\t\t{Other Provider Identifier Type Code_7},\n\t\t{Other Provider Identifier State_7},\n\t\t{Other Provider Identifier Issuer_7},\n\t\t{Other Provider Identifier_8},\n\t\t{Other Provider Identifier Type Code_8},\n\t\t{Other Provider Identifier State_8},\n\t\t{Other Provider Identifier Issuer_8},\n\t\t{Other Provider Identifier_9},\n\t\t{Other Provider Identifier Type Code_9},\n\t\t{Other Provider Identifier State_9},\n\t\t{Other Provider Identifier Issuer_9},\n\t\t{Other Provider Identifier_10},\n\t\t{Other Provider Identifier Type Code_10},\n\t\t{Other Provider Identifier State_10},\n\t\t{Other Provider Identifier Issuer_10},\n\t\t{Other Provider Identifier_11},\n\t\t{Other Provider Identifier Type Code_11},\n\t\t{Other Provider Identifier State_11},\n\t\t{Other Provider Identifier Issuer_11},\n\t\t{Other Provider Identifier_12},\n\t\t{Other Provider Identifier Type Code_12},\n\t\t{Other Provider Identifier State_12},\n\t\t{Other Provider Identifier Issuer_12},\n\t\t{Other Provider Identifier_13},\n\t\t{Other Provider Identifier Type Code_13},\n\t\t{Other Provider Identifier State_13},\n\t\t{Other Provider Identifier Issuer_13},\n\t\t{Other Provider Identifier_14},\n\t\t{Other Provider Identifier Type Code_14},\n\t\t{Other Provider Identifier State_14},\n\t\t{Other Provider Identifier Issuer_14},\n\t\t{Other Provider Identifier_15},\n\t\t{Other Provider Identifier Type Code_15},\n\t\t{Other Provider Identifier State_15},\n\t\t{Other Provider Identifier Issuer_15},\n\t\t{Other Provider Identifier_16},\n\t\t{Other Provider Identifier Type Code_16},\n\t\t{Other Provider Identifier State_16},\n\t\t{Other Provider Identifier Issuer_16},\n\t\t{Other Provider Identifier_17},\n\t\t{Other Provider Identifier Type Code_17},\n\t\t{Other Provider Identifier State_17},\n\t\t{Other Provider Identifier Issuer_17},\n\t\t{Other Provider Identifier_18},\n\t\t{Other Provider Identifier Type Code_18},\n\t\t{Other Provider Identifier State_18},\n\t\t{Other Provider Identifier Issuer_18},\n\t\t{Other Provider Identifier_19},\n\t\t{Other Provider Identifier Type Code_19},\n\t\t{Other Provider Identifier State_19},\n\t\t{Other Provider Identifier Issuer_19},\n\t\t{Other Provider Identifier_20},\n\t\t{Other Provider Identifier Type Code_20},\n\t\t{Other Provider Identifier State_20},\n\t\t{Other Provider Identifier Issuer_20},\n\t\t{Other Provider Identifier_21},\n\t\t{Other Provider Identifier Type Code_21},\n\t\t{Other Provider Identifier State_21},\n\t\t{Other Provider Identifier Issuer_21},\n\t\t{Other Provider Identifier_22},\n\t\t{Other Provider Identifier Type Code_22},\n\t\t{Other Provider Identifier State_22},\n\t\t{Other Provider Identifier Issuer_22},\n\t\t{Other Provider Identifier_23},\n\t\t{Other Provider Identifier Type Code_23},\n\t\t{Other Provider Identifier State_23},\n\t\t{Other Provider Identifier Issuer_23},\n\t\t{Other Provider Identifier_24},\n\t\t{Other Provider Identifier Type Code_24},\n\t\t{Other Provider Identifier State_24},\n\t\t{Other Provider Identifier Issuer_24},\n\t\t{Other Provider Identifier_25},\n\t\t{Other Provider Identifier Type Code_25},\n\t\t{Other Provider Identifier State_25},\n\t\t{Other Provider Identifier Issuer_25},\n\t\t{Other Provider Identifier_26},\n\t\t{Other Provider Identifier Type Code_26},\n\t\t{Other Provider Identifier State_26},\n\t\t{Other Provider Identifier Issuer_26},\n\t\t{Other Provider Identifier_27},\n\t\t{Other Provider Identifier Type Code_27},\n\t\t{Other Provider Identifier State_27},\n\t\t{Other Provider Identifier Issuer_27},\n\t\t{Other Provider Identifier_28},\n\t\t{Other Provider Identifier Type Code_28},\n\t\t{Other Provider Identifier State_28},\n\t\t{Other Provider Identifier Issuer_28},\n\t\t{Other Provider Identifier_29},\n\t\t{Other Provider Identifier Type Code_29},\n\t\t{Other Provider Identifier State_29},\n\t\t{Other Provider Identifier Issuer_29},\n\t\t{Other Provider Identifier_30},\n\t\t{Other Provider Identifier Type Code_30},\n\t\t{Other Provider Identifier State_30},\n\t\t{Other Provider Identifier Issuer_30},\n\t\t{Other Provider Identifier_31},\n\t\t{Other Provider Identifier Type Code_31},\n\t\t{Other Provider Identifier State_31},\n\t\t{Other Provider Identifier Issuer_31},\n\t\t{Other Provider Identifier_32},\n\t\t{Other Provider Identifier Type Code_32},\n\t\t{Other Provider Identifier State_32},\n\t\t{Other Provider Identifier Issuer_32},\n\t\t{Other Provider Identifier_33},\n\t\t{Other Provider Identifier Type Code_33},\n\t\t{Other Provider Identifier State_33},\n\t\t{Other Provider Identifier Issuer_33},\n\t\t{Other Provider Identifier_34},\n\t\t{Other Provider Identifier Type Code_34},\n\t\t{Other Provider Identifier State_34},\n\t\t{Other Provider Identifier Issuer_34},\n\t\t{Other Provider Identifier_35},\n\t\t{Other Provider Identifier Type Code_35},\n\t\t{Other Provider Identifier State_35},\n\t\t{Other Provider Identifier Issuer_35},\n\t\t{Other Provider Identifier_36},\n\t\t{Other Provider Identifier Type Code_36},\n\t\t{Other Provider Identifier State_36},\n\t\t{Other Provider Identifier Issuer_36},\n\t\t{Other Provider Identifier_37},\n\t\t{Other Provider Identifier Type Code_37},\n\t\t{Other Provider Identifier State_37},\n\t\t{Other Provider Identifier Issuer_37},\n\t\t{Other Provider Identifier_38},\n\t\t{Other Provider Identifier Type Code_38},\n\t\t{Other Provider Identifier State_38},\n\t\t{Other Provider Identifier Issuer_38},\n\t\t{Other Provider Identifier_39},\n\t\t{Other Provider Identifier Type Code_39},\n\t\t{Other Provider Identifier State_39},\n\t\t{Other Provider Identifier Issuer_39},\n\t\t{Other Provider Identifier_40},\n\t\t{Other Provider Identifier Type Code_40},\n\t\t{Other Provider Identifier State_40},\n\t\t{Other Provider Identifier Issuer_40},\n\t\t{Other Provider Identifier_41},\n\t\t{Other Provider Identifier Type Code_41},\n\t\t{Other Provider Identifier State_41},\n\t\t{Other Provider Identifier Issuer_41},\n\t\t{Other Provider Identifier_42},\n\t\t{Other Provider Identifier Type Code_42},\n\t\t{Other Provider Identifier State_42},\n\t\t{Other Provider Identifier Issuer_42},\n\t\t{Other Provider Identifier_43},\n\t\t{Other Provider Identifier Type Code_43},\n\t\t{Other Provider Identifier State_43},\n\t\t{Other Provider Identifier Issuer_43},\n\t\t{Other Provider Identifier_44},\n\t\t{Other Provider Identifier Type Code_44},\n\t\t{Other Provider Identifier State_44},\n\t\t{Other Provider Identifier Issuer_44},\n\t\t{Other Provider Identifier_45},\n\t\t{Other Provider Identifier Type Code_45},\n\t\t{Other Provider Identifier State_45},\n\t\t{Other Provider Identifier Issuer_45},\n\t\t{Other Provider Identifier_46},\n\t\t{Other Provider Identifier Type Code_46},\n\t\t{Other Provider Identifier State_46},\n\t\t{Other Provider Identifier Issuer_46},\n\t\t{Other Provider Identifier_47},\n\t\t{Other Provider Identifier Type Code_47},\n\t\t{Other Provider Identifier State_47},\n\t\t{Other Provider Identifier Issuer_47},\n\t\t{Other Provider Identifier_48},\n\t\t{Other Provider Identifier Type Code_48},\n\t\t{Other Provider Identifier State_48},\n\t\t{Other Provider Identifier Issuer_48},\n\t\t{Other Provider Identifier_49},\n\t\t{Other Provider Identifier Type Code_49},\n\t\t{Other Provider Identifier State_49},\n\t\t{Other Provider Identifier Issuer_49},\n\t\t{Other Provider Identifier_50},\n\t\t{Other Provider Identifier Type Code_50},\n\t\t{Other Provider Identifier State_50},\n\t\t{Other Provider Identifier Issuer_50}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectNPPESOtherProviderIdentifiers\nDerivedColumn1 select(mapColumn(\n\t\tNPI,\n\t\tdata_month,\n\t\t{Active Flag},\n\t\t{Entity Type Code},\n\t\t{Entity Type},\n\t\t{Healthcare Provider Taxonomy Code_1},\n\t\t{Provider License Number_1},\n\t\t{Provider License Number State Code_1},\n\t\t{Healthcare Provider Primary Taxonomy Switch_1},\n\t\t{Healthcare Provider Taxonomy Code_2},\n\t\t{Provider License Number_2},\n\t\t{Provider License Number State Code_2},\n\t\t{Healthcare Provider Primary Taxonomy Switch_2},\n\t\t{Healthcare Provider Taxonomy Code_3},\n\t\t{Provider License Number_3},\n\t\t{Provider License Number State Code_3},\n\t\t{Healthcare Provider Primary Taxonomy Switch_3},\n\t\t{Healthcare Provider Taxonomy Code_4},\n\t\t{Provider License Number_4},\n\t\t{Provider License Number State Code_4},\n\t\t{Healthcare Provider Primary Taxonomy Switch_4},\n\t\t{Healthcare Provider Taxonomy Code_5},\n\t\t{Provider License Number_5},\n\t\t{Provider License Number State Code_5},\n\t\t{Healthcare Provider Primary Taxonomy Switch_5},\n\t\t{Healthcare Provider Taxonomy Code_6},\n\t\t{Provider License Number_6},\n\t\t{Provider License Number State Code_6},\n\t\t{Healthcare Provider Primary Taxonomy Switch_6},\n\t\t{Healthcare Provider Taxonomy Code_7},\n\t\t{Provider License Number_7},\n\t\t{Provider License Number State Code_7},\n\t\t{Healthcare Provider Primary Taxonomy Switch_7},\n\t\t{Healthcare Provider Taxonomy Code_8},\n\t\t{Provider License Number_8},\n\t\t{Provider License Number State Code_8},\n\t\t{Healthcare Provider Primary Taxonomy Switch_8},\n\t\t{Healthcare Provider Taxonomy Code_9},\n\t\t{Provider License Number_9},\n\t\t{Provider License Number State Code_9},\n\t\t{Healthcare Provider Primary Taxonomy Switch_9},\n\t\t{Healthcare Provider Taxonomy Code_10},\n\t\t{Provider License Number_10},\n\t\t{Provider License Number State Code_10},\n\t\t{Healthcare Provider Primary Taxonomy Switch_10},\n\t\t{Healthcare Provider Taxonomy Code_11},\n\t\t{Provider License Number_11},\n\t\t{Provider License Number State Code_11},\n\t\t{Healthcare Provider Primary Taxonomy Switch_11},\n\t\t{Healthcare Provider Taxonomy Code_12},\n\t\t{Provider License Number_12},\n\t\t{Provider License Number State Code_12},\n\t\t{Healthcare Provider Primary Taxonomy Switch_12},\n\t\t{Healthcare Provider Taxonomy Code_13},\n\t\t{Provider License Number_13},\n\t\t{Provider License Number State Code_13},\n\t\t{Healthcare Provider Primary Taxonomy Switch_13},\n\t\t{Healthcare Provider Taxonomy Code_14},\n\t\t{Provider License Number_14},\n\t\t{Provider License Number State Code_14},\n\t\t{Healthcare Provider Primary Taxonomy Switch_14},\n\t\t{Healthcare Provider Taxonomy Code_15},\n\t\t{Provider License Number_15},\n\t\t{Provider License Number State Code_15},\n\t\t{Healthcare Provider Primary Taxonomy Switch_15},\n\t\t{Healthcare Provider Taxonomy Group_1},\n\t\t{Healthcare Provider Taxonomy Group_2},\n\t\t{Healthcare Provider Taxonomy Group_3},\n\t\t{Healthcare Provider Taxonomy Group_4},\n\t\t{Healthcare Provider Taxonomy Group_5},\n\t\t{Healthcare Provider Taxonomy Group_6},\n\t\t{Healthcare Provider Taxonomy Group_7},\n\t\t{Healthcare Provider Taxonomy Group_8},\n\t\t{Healthcare Provider Taxonomy Group_9},\n\t\t{Healthcare Provider Taxonomy Group_10},\n\t\t{Healthcare Provider Taxonomy Group_11},\n\t\t{Healthcare Provider Taxonomy Group_12},\n\t\t{Healthcare Provider Taxonomy Group_13},\n\t\t{Healthcare Provider Taxonomy Group_14},\n\t\t{Healthcare Provider Taxonomy Group_15}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectNPPESProviderTaxonomy\nSelectNPPESProviderTaxonomy select(mapColumn(\n\t\teach(match(true()),\n\t\t\tlower($$) = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> LowerCaseProvTaxonomy\nSelectNPPESOtherProviderIdentifiers select(mapColumn(\n\t\teach(match(true()),\n\t\t\tlower($$) = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> LowerCaseOtherProvId\nSelectNPPESMain select(mapColumn(\n\t\teach(match(true()),\n\t\t\tlower($$) = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> LowerNPPESMain\nLowerNPPESMain sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sinkNPPESMain\nLowerCaseOtherProvId sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sinkNPPESOtherProvider\nLowerCaseProvTaxonomy sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sinkProviderTaxonomy"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/PUF_DS_1_ld_cms_nppes')]",
				"[concat(variables('factoryId'), '/datasets/PUF_DS_1_ld_cms_nppes_other_provider_identifiers')]",
				"[concat(variables('factoryId'), '/datasets/PUF_DS_1_LD_cms_nppes_provider_taxonomy')]"
			]
		}
	]
}